<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8"/>
<meta name="viewport" content="width=device-width,initial-scale=1"/>
<title>Device Status Logger â€” Neon Glacial</title>
<style>
  @import url('https://fonts.googleapis.com/css2?family=Inter:wght@400;600&display=swap');

  body {
    font-family: 'Inter', sans-serif;
    margin: 0;
    overflow: hidden;
    height: 100vh;
    background: url('https://files.catbox.moe/c29z2z.jpg') center/cover no-repeat;
    position: relative;
  }

  /* Frosted glass overlay */
  .overlay {
    position: absolute;
    inset: 0;
    display: flex;
    flex-direction: column;
    justify-content: center;
    align-items: center;
    backdrop-filter: blur(14px) saturate(180%);
    background-color: rgba(10, 15, 25, 0.55);
  }

  h1 {
    color: #7dd3fc;
    font-size: 1.8rem;
    text-shadow: 0 0 15px #38bdf8;
    margin-bottom: 20px;
    animation: neonPulse 2.5s infinite alternate;
  }

  .btn {
    padding: 12px 26px;
    margin: 10px;
    border-radius: 10px;
    border: 1px solid rgba(255,255,255,0.15);
    color: #e6eef7;
    font-size: 15px;
    cursor: pointer;
    transition: all 0.2s ease-in-out;
    backdrop-filter: blur(10px);
    background: rgba(255,255,255,0.05);
    box-shadow: 0 0 8px rgba(125,211,252,0.2);
  }

  .btn.primary {
    background: linear-gradient(90deg,#0369a1,#0891b2);
    color: white;
    box-shadow: 0 0 20px rgba(56,189,248,0.4);
  }

  .btn:hover {
    transform: scale(1.05);
    box-shadow: 0 0 25px rgba(56,189,248,0.5);
  }

  #log {
    display: none;
    width: 90%;
    max-width: 700px;
    margin-top: 20px;
    background: rgba(4,16,34,0.7);
    border-radius: 10px;
    padding: 20px;
    overflow-y: auto;
    max-height: 60vh;
    color: #e6eef7;
    box-shadow: 0 0 20px rgba(56,189,248,0.3);
  }

  .record {
    border-bottom: 1px dashed rgba(125,211,252,0.2);
    padding: 8px 0;
  }

  .field span {
    color: #7dd3fc;
    font-weight: 600;
  }

  @keyframes neonPulse {
    from { text-shadow: 0 0 8px #38bdf8; }
    to { text-shadow: 0 0 22px #0ea5e9; }
  }

  /* Ripple effect canvas */
  canvas#ripple {
    position: fixed;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    pointer-events: none;
  }
</style>
</head>
<body>

<canvas id="ripple"></canvas>

<div class="overlay">
  <h1>Device Status Logger â€” Neon Mode</h1>
  <div>
    <button id="collectBtn" class="btn primary">Collect & Send</button>
    <button id="collectLocal" class="btn">Collect Locally</button>
    <button id="showKeyBtn" class="btn">Show Logs</button>
  </div>

  <div id="log"></div>
</div>

<script>
let collectedPayloads = [];

function displayLogs() {
  const logEl = document.getElementById('log');
  logEl.innerHTML = '';
  logEl.style.display = 'block';

  collectedPayloads
    .sort((a,b)=>new Date(b.collectedAt)-new Date(a.collectedAt))
    .forEach(payload => {
      const r = document.createElement('div');
      r.className = 'record';
      r.innerHTML = `
        <div class="field"><span>Time:</span> ${new Date(payload.collectedAt).toLocaleString()}</div>
        <div class="field"><span>Device:</span> ${payload.platform || 'N/A'}</div>
        <div class="field"><span>User Agent:</span> ${payload.userAgent || 'N/A'}</div>
        <div class="field"><span>Cores:</span> ${payload.cores || 'N/A'}</div>
        <div class="field"><span>Memory:</span> ${payload.deviceMemoryGB || 'N/A'} GB</div>
        <div class="field"><span>Languages:</span> ${payload.languages?.join(', ') || 'N/A'}</div>
        <div class="field"><span>Timezone:</span> ${payload.timeZone || 'N/A'}</div>
        <div class="field"><span>Geo:</span> ${payload.geolocation ? JSON.stringify(payload.geolocation) : 'N/A'}</div>
        <div class="field"><span>Battery:</span> ${payload.battery ? JSON.stringify(payload.battery) : 'N/A'}</div>
        <div class="field"><span>Media Devices:</span> ${payload.mediaDevices ? JSON.stringify(payload.mediaDevices) : 'N/A'}</div>
      `;
      logEl.appendChild(r);
    });
}

function gatherBasic(){
  const nav = navigator;
  return {
    collectedAt: new Date().toISOString(),
    userAgent: nav.userAgent || null,
    platform: nav.platform || null,
    languages: nav.languages || [nav.language || null],
    cores: nav.hardwareConcurrency || null,
    deviceMemoryGB: nav.deviceMemory || null,
    timeZone: Intl.DateTimeFormat().resolvedOptions().timeZone || null
  };
}

async function gatherBattery(){
  if (!('getBattery' in navigator)) return null;
  try { const b = await navigator.getBattery(); return {charging:b.charging, level:b.level}; }
  catch(e){ return null; }
}

function gatherGeolocation(){
  return new Promise(res=>{
    if(!navigator.geolocation) return res(null);
    navigator.geolocation.getCurrentPosition(pos=>res({lat:pos.coords.latitude,lon:pos.coords.longitude,acc:pos.coords.accuracy}),
    err=>res({error:err.message}));
  });
}

async function gatherMediaDevices(){
  if(!navigator.mediaDevices?.enumerateDevices) return null;
  try {
    await navigator.mediaDevices.getUserMedia({audio:true,video:true}).catch(()=>{});
    const d = await navigator.mediaDevices.enumerateDevices();
    return d.map(x=>({kind:x.kind,label:x.label||null}));
  } catch(e){ return null; }
}

async function collectDevice(send=false){
  const payload = gatherBasic();
  payload.battery = await gatherBattery();
  payload.geolocation = await gatherGeolocation();
  payload.mediaDevices = await gatherMediaDevices();
  collectedPayloads.push(payload);
  if(send){
    try{ await fetch('/logs',{method:'POST',headers:{'content-type':'application/json'},body:JSON.stringify(payload)}); }
    catch(e){ console.error(e); }
  }
  alert('Device info collected â€” logs hidden until key entered.');
}

document.getElementById('collectBtn').onclick=()=>collectDevice(true);
document.getElementById('collectLocal').onclick=()=>collectDevice(false);
document.getElementById('showKeyBtn').onclick=async()=>{
  const key=prompt('Enter access key:')?.trim();
  if(key==='54321'){
    try{
      const res=await fetch('/logs?key=54321');
      const data=await res.json();
      collectedPayloads=data;
      displayLogs();
      alert('âœ… Access granted â€” showing logs');
    }catch(e){alert('Error fetching logs');}
  } else alert('Access denied');
};

/* ðŸŒŠ Ripple Effect */
const canvas = document.getElementById('ripple');
const ctx = canvas.getContext('2d');
let ripples = [];

function resize() {
  canvas.width = innerWidth;
  canvas.height = innerHeight;
}
window.addEventListener('resize', resize);
resize();

function draw() {
  ctx.clearRect(0, 0, canvas.width, canvas.height);
  for (let i = 0; i < ripples.length; i++) {
    const r = ripples[i];
    ctx.beginPath();
    ctx.arc(r.x, r.y, r.radius, 0, Math.PI * 2);
    ctx.strokeStyle = `rgba(125,211,252,${r.alpha})`;
    ctx.lineWidth = 2;
    ctx.stroke();
    r.radius += 2;
    r.alpha -= 0.015;
    if (r.alpha <= 0) ripples.splice(i, 1);
  }
  requestAnimationFrame(draw);
}
draw();

window.addEventListener('pointerdown', e=>{
  ripples.push({x:e.clientX, y:e.clientY, radius:0, alpha:1});
});
</script>
</body>
</html>
